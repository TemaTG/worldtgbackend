# WorldTG Backend ‚Äì Render¬†Auto‚ÄëDeploy

–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backend + –≤–æ—Ä–∫–µ—Ä –¥–ª—è Telegram¬†Mini¬†App **WorldTG**  
(–æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ CryptoBot, –ø–æ–∫—É–ø–∫–∞ –Ω–æ–º–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ SMSBower, –≤—ã–¥–∞—á–∞ –∫–æ–¥–∞ –≤ Telegram).

## 1. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
cp .env.example .env           # –≤—Å—Ç–∞–≤—å —Å–≤–æ–∏ —Ç–æ–∫–µ–Ω—ã –∏ DATABASE_URL
npm install
npm run start                  # —Å–µ—Ä–≤–∏—Å  http://localhost:3000
npm run worker                 # –≤–æ—Ä–∫–µ—Ä, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
```

–î–ª—è —Ç–µ—Å—Ç–æ–≤ –≤–µ–±—Ö—É–∫–æ–≤ –ª–æ–∫–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ –ø—Ä–æ–±—Ä–æ—Å–∏—Ç—å –ø–æ—Ä—Ç —á–µ—Ä–µ–∑ `ngrok`:

```bash
ngrok http 3000
# —Å–∫–æ–ø–∏—Ä—É–π HTTPS‚ÄëURL –∏ –ø–æ—Å—Ç–∞–≤—å –≤ CryptoBot ‚Üí Edit¬†Webhook
```

## 2. –î–µ–ø–ª–æ–π –Ω–∞ Render

1. Fork / –∑–∞–ª–µ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ GitHub.  
2. –í Render:
   * **New ‚Ü† Web¬†Service** ‚Äì Build¬†Cmd `npm i`, Start¬†Cmd `npm start`.  
   * **+ Add Environment Variable** ‚Äì –ø–µ—Ä–µ–Ω–µ—Å–∏ –≤—Å–µ –∏–∑ `.env.example`.  
3. **New ‚Ü† Background¬†Worker** ‚Äì Build¬†Cmd `npm i`, Start¬†Cmd `npm run worker`.  
4. –î–æ–±–∞–≤—å URL `https://<service>.onrender.com/webhook/cryptobot` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö @CryptoBot.  
5. –ì–æ—Ç–æ–≤–æ! –û–ø–ª–∞—Ç–∞ ‚Üí –Ω–æ–º–µ—Ä ‚Üí –∫–æ–¥ ‚Üí –∞–≤—Ç–æ–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞.

## 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

Render –∏–º–µ–µ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π PostgreSQL Add‚ÄëOn. –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å–∫–æ–ø–∏—Ä—É–π DSN –≤ `DATABASE_URL`.  
–¢–∞–±–ª–∏—Ü–∞ `orders` —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å—Ç–∞—Ä—Ç–µ.

## 4. –ß—Ç–æ –¥–∞–ª—å—à–µ

* **–†–µ—Ñ–∞–Ω–¥—ã** ‚Äî –¥–æ–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é `cancelAndRefund`, –µ—Å–ª–∏ –∫–æ–¥ –Ω–µ –ø—Ä–∏—à—ë–ª.  
* **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** ‚Äî Render Metrics + Logtail –∏–ª–∏ –ª—é–±–∞—è APM.  
* **–û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á** ‚Äî –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ polling –≤ BullMQ + Redis Cloud.

Enjoy üöÄ
